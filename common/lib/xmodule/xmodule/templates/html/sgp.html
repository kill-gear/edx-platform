<h4>{{display_name}}</h4>
<hr>
{{instructions|safe}}

{% if score.score %}
<h3>Your grade: <strong>{{score.grade_pct}}</strong></h3>
{% else %}
{% if grades_available %}
<p><em>Not yet scored</em></p>
{% else %}
<p><em>View in LMS to see score</em></p>
{% endif %}
{% endif %}
{% if is_staff and grades_available %}
<div class="row">
    <div class="col">
        <hr>
        <p>Please upload a CSV with the grades. Thanks. Have a nice day.</p>
        <form action="{{import_url}}" method="POST" enctype="multipart/form-data">
            <input type="hidden" name="csrfmiddlewaretoken" value="{{csrf_token}}">
            <p>
                <a href="{{export_url}}" class="btn btn-brand">download CSV</a>
                <input id="{{id}}-file" type="file" name="csv">
                <a href="#" id="{{id}}-import" class="submit btn btn-brand">import CSV</a>
                <h2 id="{{id}}-status" class="text-info" style="display:none"></h2>
            </p>
        </form>
    </div>
</div>
<script type="text/javascript">
    $('#{{id}}-import').click(function(e){
        e.preventDefault();
        var formData = new FormData();
        formData.append('csrfmiddlewaretoken', '{{csrf_token}}');
        formData.append('csv', $('#{{id}}-file')[0].files[0]);

        $.ajax({
               url : '{{import_url}}',
               type : 'POST',
               data : formData,
               processData: false,  // tell jQuery not to process the data
               contentType: false,  // tell jQuery not to set contentType
               success : function(data) {
                   console.log(data);
                    $('#{{id}}-status').html(`${data.processed} processed. ${data.errors} errors`).show();
               }
        });

    });
</script>
{% else %}
{% endif %}
